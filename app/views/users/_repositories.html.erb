<% if @repositories.empty? or params[:show].eql?('makes') and @makes.empty? %>
    <%= tag.div("#{@repo_user.username} doesn't have any repositories yet.", class: 'empty-repo') %>
<% else %>
    <div class="apple_pagination">
        <%= page_entries_info @repositories, model: 'Repository' %>
        <%= will_paginate @repositories, container: false %>
    </div>
    <br>
<% end %>
<% if params[:show].eql?('makes') %>
    <% repos = @makes %>
<% else %>
    <% repos = params[:show].eql?('projects_assigned') ? @joined_projects : @repositories %>
<% end %>
<% if repos !=@joined_projects %>
    <% repos.each do |repository| %>
        <div class="repository-container">
            <div class="repo-display-wrapper" <%= "style=background-image:url('#{url_for(repository.photos.first.image) if repository.photos.present? && repository.photos.first.present? && repository.photos.first.image.attached?}')" %> >
                <% if repository.user_username.eql?(@user.username) %>
                    <%= link_to 'Delete', repository_path(repository.user_username, repository.id), method:
                        :delete, data: {
                                   confirm: 'Are you sure? Once you delete the repository there is no coming back!'
                                 },
                                                                                                    class: 'btn btn-danger btn-sm float-end m-1', style: 'display: none' %>
                    <%= link_to 'Edit', edit_repository_path(repository.user_username, repository.id),
                                class: 'btn btn-secondary btn-sm float-end m-1', style: 'display: none' %>
                <% end %>
                <%= link_to '', repository_path(repository.user_username, repository.slug),
                            class: 'link' %>
            </div>
            <div class="repo-info">
                <div class="start">
                    <div class="likes">
                        <%= fa_icon 'heart' %><br>
                        <%= repository.like %>
                    </div>
                    <div class="title">
                        <%= link_to repository.title, repository_path(repository.user_username, repository.slug) %>
                    </div>
                    <div>by <%= link_to repository.user_username, user_path(repository.user_username) %>
                    </div>
                    <div>
                        <%= time_ago_in_words(repository.created_at) << ' ago' %>
                    </div>
                </div>
            </div>
        </div>
    <% end %>
<% else %>
    <% repos.each do |joined_project| %>
        <table class="spacing_table">
            <thead>
                <tr>
                    <th>Project Proposal</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="titlepp">
                        <%= joined_project.project_proposal.title %>
                    </td>
                    <td>
                        <%= link_to 'Show', joined_project.project_proposal, class: 'green-button' %>
                    </td>
                </tr>
            </tbody>
        </table>
    <% end %>
<% end %>
